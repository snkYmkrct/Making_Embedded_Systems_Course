# Air Quality Monitor 

## Motivation
From measuring CO2 levels in a crowded room for Covid19 (and other respiratory infections) prevention, to tracking air pollution in the city, to checking if the soldering fume extractor is working properly, portable air quality monitors are useful tools to have around.  And luckily, they are (relatively) cheap and easy to DIY.

The purpose of this project is to build one of these air quality monitors, using 2 sensor initially, a true CO2 sensor, and an air particles sensor, with the possibility to add others in the future (like a volatile organic compounds sensor, etc). 

I've designed this project to be used as both a portable device on battery, and a room monitor, with the addition of a RGB lamp for distance notification.

## Hardware
- STM32F429I-DISC1 Discovery board (using the touch screen interface)
- PMSA003I air particle sensor breakout board on I2C
- SCD-40 Co2 sensor breakout board on I2C
- DS3231 Precision RTC breakout board on I2C
- Potentiometers, buttons
- WS2812B (Neopixel) LED ring
- Adafruit PowerBoost 1000 Charger
- Rechargable LiPo Battery / Power supply 
 
### Hardware Block Diagram
![HW DIAGRAM](https://github.com/snkYmkrct/Making_Embedded_Systems_Course/blob/main/Week%204%20homework/Week%204%20Homework-HW%20diagram.png?raw=true)


## Toolchain and Software

- Working on Windows 10 / 11
- STM32CubeIDE Version: 1.9.0
- TouchGFX Designer Version: 4.19.1


### Software Block Diagram 
![SW DIAGRAM](https://github.com/snkYmkrct/Making_Embedded_Systems_Course/blob/main/Week%204%20homework/Week%204%20Homework-SW%20block%20diagram.png?raw=true)


### Software Hierarchy of Control
![SW CONTROL](https://github.com/snkYmkrct/Making_Embedded_Systems_Course/blob/main/Week%204%20homework/Week%204%20Homework-SW%20Hierarchy%20of%20Control.png?raw=true)


### State machine
Flow Chart state machine
![FLOW](https://github.com/snkYmkrct/Making_Embedded_Systems_Course/blob/main/Week%204%20homework/Week%204%20Homework-Flow%20Chart%20state%20machine.png?raw=true)

Current version of the state table: https://docs.google.com/spreadsheets/d/1JimFYMGVc1ZfjMCN791TDpzwdjA5hTvn5mYWAqrn6kg/edit?usp=sharing

### Code

- generated by the toolchain - HAL for the board
- BSP libraries from ST (insert exact versions used)
- Neopixel library
- LICENCES !!!
- ...
- list modified files

### Build instructions
- 
- .

## Testing 
- debugging :  over St-Link interface
- serial console commands
- battery life tests - extra necessary hardware needed ??? 


## Tasks to complete

### Minimum for working project
- Get the display and touch screen interface working 
- Connect and collect the data from the I2C sensors
- Connect and control the Neopixels, change color and brightness
- Create UI on screen, display information collected from sensors
- Make the color of the LEDs change based on sensor data
- Power the board from battery
- Support for serial console

### Nice to have
- Build an enclosure to make it properly portable (I don't know how to use CAD 3D design, so... cardboard? lol)
- Enclosure for the Neopixels working as a diffuser (lamp)
- **__Make the Neopixel lamp detachable to allow the project to be smaller / more portable / save battery -- would display info only on screen.__**
- add sleep modes - with button for wakeup 
- power usage analysis - extra hardware needed ?

### If there is time, plus credit work
- log the data from the sensors, with time stamps
- add ESP32 co-processor on SPI for WiFi capability --> log data in the cloud
- HW watchdog support 

For production:  smaller board, one that doesn't carry the stlink programmer board with it :D




